{% extends 'base.html' %}
{% block title %}Upbit AutoTrading · 리스크 매니지먼트{% endblock %}
{% block content %}
<style>
body{background:#f6f8fb;font-size:18px;}
.navbar{background:#1e2b45;}
.card-head{background:#22315a;color:#fff;font-size:1.25rem;padding:1.2rem 2rem;display:flex;align-items:center;gap:.7rem;border-radius:1.25rem 1.25rem 0 0;}
.card{border-radius:1.25rem;margin-bottom:2.5rem;box-shadow:0 4px 24px #0001;}
.card-body{padding:2.5rem;}
label.form-label{font-size:1.08rem;font-weight:600;color:#233;}
input.form-control,select.form-select{font-size:1.1rem;padding:0.9rem 1.1rem;}
input[type="number"],input[type="text"]{max-width:220px;}
.btn-primary{padding:.8rem 2.5rem;font-size:1.15rem;}
.btn-lg{font-size:1.18rem;}
.container{max-width:980px;margin-top:56px;}
.section-label{font-size:1.18rem;font-weight:700;color:#3753a9;margin-bottom:1.2rem;}
.bi-shield-check,.bi-bell{font-size:2rem;color:#40b4a8;}
.card-toolbar {display:flex;gap:1.5rem;flex-wrap:wrap;}
@media (max-width:1100px) {.container{max-width:98vw;}}
</style>

<div class="container">

  <!-- 리스크 관리 입력폼 -->
  <div class="card shadow-sm mb-5">
    <div class="card-head">
      <i class="bi bi-shield-check"></i> 리스크 관리 & 알림
      <i class="bi bi-question-circle ms-auto" data-bs-toggle="tooltip" title="일/주/월 손실 한도, 자동 손절, 알림, 로그 등 리스크를 체계적으로 관리합니다."></i>
    </div>
    <div class="card-body">
      <form>
        <div class="row mb-4 align-items-center">
          <div class="col-3">
            <label class="form-label"><i class="bi bi-graph-down-arrow me-2"></i>손실 한도</label>
          </div>
          <div class="col">
            <input type="number" class="form-control" placeholder="일간(%)">  
          </div>
          <div class="col">
            <input type="number" class="form-control" placeholder="주간(%)">  
          </div>
          <div class="col">
            <input type="number" class="form-control" placeholder="월간(%)">  
          </div>
        </div>
        <div class="mb-4">
          <label class="form-label"><i class="bi bi-bell me-2"></i>알림 설정</label>
          <div class="form-check form-switch mb-2">
            <input class="form-check-input" type="checkbox" id="push1">
            <label class="form-check-label" for="push1">익절/손절시 푸시 알림</label>
          </div>
          <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="push2">
            <label class="form-check-label" for="push2">텔레그램 알림 연동</label>
          </div>
        </div>
        <div class="row mb-4 align-items-center">
          <div class="col-4">
            <label class="form-label"><i class="bi bi-x-octagon me-2"></i>강제 매도/손절 기준</label>
          </div>
          <div class="col">
            <input type="number" class="form-control" placeholder="손실 퍼센트(%) 기준">
          </div>
          <div class="col">
            <input type="number" class="form-control" placeholder="연속 손실 허용(횟수)">
          </div>
        </div>
        <div class="row mb-4 align-items-center">
          <div class="col-4">
            <label class="form-label"><i class="bi bi-exclamation-diamond me-2"></i>연속 손실/수익 자동 중지</label>
          </div>
          <div class="col">
            <input type="number" class="form-control" placeholder="연속 손실(횟수)">
          </div>
          <div class="col">
            <input type="number" class="form-control" placeholder="연속 수익(횟수)">
          </div>
        </div>
        <div class="mb-4">
          <label class="form-label"><i class="bi bi-file-earmark-arrow-down me-2"></i>로그 기록/내보내기</label>
          <div class="input-group mb-2">
            <input type="text" class="form-control" placeholder="CSV 로그 파일 경로">
            <button class="btn btn-outline-secondary" type="button"><i class="bi bi-download"></i> 내보내기</button>
          </div>
        </div>
        <button type="submit" class="btn btn-primary w-100 mt-2">저장</button>
      </form>
      <div class="mt-4 text-muted">마지막 저장: 2025-05-18 15:15</div>
    </div>
  </div>

  <!-- 추가 기능: 로그/이력/백업/복구/다운로드 -->
  <div class="card shadow-sm mb-5">
    <div class="card-head">
      <i class="bi bi-hdd-stack"></i> 고급 로그 관리 · 감사 이력 · 백업/복구
      <i class="bi bi-question-circle ms-auto" data-bs-toggle="tooltip" title="로테이션/레벨/감사이력/백업/복구를 한눈에!"></i>
    </div>
    <div class="card-body">
      <div class="card-toolbar mb-4">
        <button class="btn btn-outline-primary btn-lg" onclick="openLogManager()">
          <i class="bi bi-folder2-open"></i> 로그 파일 관리/로테이션
        </button>
        <button class="btn btn-outline-success btn-lg" onclick="openAuditHistory()">
          <i class="bi bi-clock-history"></i> 감사로그 조회/다운로드
        </button>
        <button class="btn btn-outline-warning btn-lg" onclick="openBackupRestore()">
          <i class="bi bi-cloud-arrow-down"></i> 백업/복구/다운로드
        </button>
      </div>
      <div>
        <ul>
          <li>logs/ 폴더에 시스템/에러/매매/이벤트 로그를 각각 10MB, 30일 보관</li>
          <li>감사이력: 모든 설정/AI/리스크변경 이력 CSV/JSON 기록 및 즉시 다운로드</li>
          <li>백업: 1일 1회 자동, 수동 다운로드/복구도 웹UI에서 지원</li>
        </ul>
        <div class="alert alert-info mt-4">
          <i class="bi bi-info-circle"></i>
          실제 파일 목록, 다운로드/복구/이력조회는 서버 연동 필요!  
          (AJAX/Flask API/파일 연동으로 확장)
        </div>
      </div>
    </div>
  </div>
</div>
<script>
document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(el=>new bootstrap.Tooltip(el));
function openLogManager(){ alert('로그 파일 관리/로테이션(서버 API 필요)'); }
function openAuditHistory(){ alert('감사로그 실시간 조회/다운로드(서버 API 필요)'); }
function openBackupRestore(){ alert('설정/포지션/로그 백업 및 복구(서버 API 필요)'); }
</script>
{% endblock %}
